# Type define oneplus camera domain
type oneplus_camera_app, domain, coredomain;

app_domain(oneplus_camera_app)

allow oneplus_camera_app app_data_file:dir { getattr search };
allow oneplus_camera_app app_data_file:file { execute };

allow oneplus_camera_app self:udp_socket { connect create };
allow oneplus_camera_app dnsproxyd_socket:sock_file { write };
allow oneplus_camera_app netd:unix_stream_socket { connectto };
dontaudit oneplus_camera_app system_file:file { lock };

allow oneplus_camera_app activity_service:service_manager { find };
allow oneplus_camera_app audio_service:service_manager { find };
allow oneplus_camera_app audioserver_service:service_manager { find };
allow oneplus_camera_app cameraserver_service:service_manager { find };
allow oneplus_camera_app content_capture_service:service_manager { find };
allow oneplus_camera_app device_state_service:service_manager { find };
allow oneplus_camera_app game_service:service_manager { find };
allow oneplus_camera_app gpu_service:service_manager { find };
allow oneplus_camera_app hint_service:service_manager { find };
allow oneplus_camera_app mediaextractor_service:service_manager { find };
allow oneplus_camera_app mediametrics_service:service_manager { find };
allow oneplus_camera_app mediaserver_service:service_manager { find };
allow oneplus_camera_app nfc_service:service_manager { find };
allow oneplus_camera_app package_native_service:service_manager { find };
allow oneplus_camera_app radio_service:service_manager { find };
allow oneplus_camera_app sensorservice_service:service_manager { find };
allow oneplus_camera_app shortcut_service:service_manager { find };
allow oneplus_camera_app surfaceflinger_service:service_manager { find };
allow oneplus_camera_app thermal_service:service_manager { find };
allow oneplus_camera_app trust_service:service_manager { find };
allow oneplus_camera_app usb_service:service_manager { find };

allow oneplus_camera_app sysfs_battery_supply:dir r_dir_perms;
allow oneplus_camera_app sysfs_battery_supply:file rw_file_perms;

binder_call(oneplus_camera_app, hal_camera_default)

#allow oneplus_camera_app hal_cameraHIDL_hwservice:hwservice_manager { find };
#binder_call(oneplus_camera_app, hal_cameraHIDL_default)

get_prop(oneplus_camera_app, camera_prop)
